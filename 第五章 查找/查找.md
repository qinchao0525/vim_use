# 查找
英文原文链接为：https://anuragpeshne.github.io/essays/vim/1.html<br>
如果你想在文档中查找一些单词，那么`/`将会显现出很大的作用来。<br>

### 第六课
```
`/`来查找关键词
```
* 在vim中我们会经常查找一些关键词，而查找的结果通常会标亮显示。
* 输入`n`到达下一个查找到的位置<br>
  输入`N`到达前一个查找到的位置
* 输入<shift>-/(?)来进行后向查找

### 正则
使用正则表达可以加快查找的进度，可以更加精确的查找到需要找到的文本，下面是正则表达式一般会用到的字符:<br>
1. 正则表达式表示了一系列字符串匹配规则。<br>
2. `*`是一个被经常使用的字符，它的作用是匹配0个或多个字符
    * 例如 `ba*`可以用来匹配`'b'`,`'ba'`,`'baa'`,`'baaa'`,`'baaaaaaa'`,......
    * `+`具有相似的功能，但是它表示的是匹配一次或多次
3. `.`用来匹配单个字符
    * 例如`b.t`，就会匹配`bit`，`bat`，`but`，`bot`，`b%t`，......
4. 如果输入的是一个单词，那么就会匹配这个单词，而不会进行别的查找
    * `help`只会匹配‘help’
    * 如果只想匹配前面的可以使用`\.`
    * 例如`bit\.`就只会匹配'bit'
5. `[...]`匹配`[]`之内的任意字符
    * `[1234567890]`就会匹配任意一个单数字
    * `[0-9]`就会像`[a-zA-Z]`，匹配任意一个字符
    
# 替换
用来替换的语法是这样的：<br>
`:%s/foo/bar/gc`<br>
该命令实现使用bar去替换foo。<br>
有的人可能认为，这个方法太过复杂，在别的编辑里面可能只需要`ctrl+r`，然后在输入foo和bar即可实现。但<br>
是，如果你花足够的时间使用Vim， 你就会意识到，Vim还具有更多的一般性的命令模式，一旦你掌握这些命令模<br>
式，你就会发现，应用这些命令会非常简单。<br>
接着来分解一下上面的替换命令：<br>
`:%s/foo/bar/gc`<br>
* `:`表示进入命令输入的模式
* `%`表示在整个文件中运行命令
    * 当然也可以改变，例如使用`12, 34`表示在第12行到第34行中间运行
    * 范围的声明是非常有用的，它可以更加明确的确定替换目标的范围
        * 参数`c`确认是否替换， 参数`g`表示单行内所有匹配项， 还有一个参数`i`表示忽略大小写
* `s`表示查找
    * 后面会介绍更多命令参数`g`的用法
* `foo`需要查找的对象
* `bar`需要替换的对象
* `g`和`c`表示的是标识位
    * `g`全局查找
    * `c`确认是否替换
    * 还有一个参数`i`表示忽略大小写
    
## 正则表达式
正则表达式可以帮助我们很方便的实现替换。<br>
例如：<br>
```
1:var fun1 = function() {
2:                return "I am fun1";
3:            }
4:var fun2 = fucntion() {
5:                return "I am fun2";
6:            }
7:var fun3 = function() {
8:                return "I am fun3";
9:            }
```
如果我们要实现代码重构，在实现中，把上述函数中的内容从新封装为一个函数：<br>
```
function fun1() {
  return "I am fun1";
}
function fun1() {
  return "I am fun2";
}
function fun1() {
  return "I am fun3";
}
```
* 很显然，上面的只有小部分的代码是不同的，大部分的内容并没有很大的变化，我们可以使用正则表达式去获得变<br>
化的部分。
* 因此，写一个正则表达式来获取变化模式：`var (\w+) = function () {`
    * 通过获取模式，可以实现“后向引用”
    * 使用\1或者\2来实现后向第一个引用，第二个引用，一次类推
* 重构如下：<br>
`:%s/var \(\w\+\) = function () {/function \1 () {/`<br>
`       | 正则  |                                  `<br>
`   | 旧的                        | 新的           |`<br>
   
    * 替换变量。在正规表达式中使用 \( 和 \) 符号括起正规表达式，即可在后面使用\1、\2等变量来访问 \( 
    和 \) 中的内容。
    * \w 匹配单词字母，等同于[0-9A-Za-z_]
* 为了说明范围的特殊情况，假设我们只需要重构前两个函数，这样应该怎么办呢？一下用两种方法来说明实现方式：<br>
    * 添加c标识，在每次替换之前都会询问我们是否执行，如果否定了，就会跳到下一个。
        * 但是这样存在问题，假设有100匹配的，那即意味着我们必须敲击100下`n`
    * 我们可以使用范围语法实现
        * 仅仅让1,6行之间进行匹配。命令模式为：
        `:1,6s/var \(\w\+\) = function () {/function \1 () {/`<br>
### 第七课
替换命令：<br>
`:[范围]s/<旧词>/<新词>/[标志位]`<br>
特殊范围的精确替换，记得使用`c`。记得使用匹配模式，使用子匹配模式可以引用，在正规表达式中使用 \( 和 \) <br>
符号括起正规表达式，即可在后面使用\1、\2等变量来访问 \( 和 \) 中的内容。

### 小技巧
如果在重构完成以后，代码变得很混乱，那么使用`=`看可以自动对齐，同样，它也可以组成复合命令：<br>
* `=G`表示自动对齐到缓冲区的结束
* `==`表示对齐当前行
* `=4<下移标识>`表示对齐接下来的四行
